#å®Œæ•´yaml
#ç”±è®¢é˜…ã€ä»£ç†ç»„ã€è§„åˆ™ã€dnsç»„æˆ
# 1. åŸºç¡€è¿è¡Œè®¾ç½® (è¡¥å…¨éƒ¨åˆ†)
#======================================================================
# HTTP å’Œ SOCKS5 æ··åˆä»£ç†ç«¯å£
mixed-port: 7890
# Redir ä»£ç†ç«¯å£ï¼ˆç”¨äºé€æ˜ä»£ç†ï¼Œè·¯ç”±å™¨ç­‰ç¯å¢ƒï¼‰
# redir-port: 7892
# å…è®¸æ¥è‡ªå±€åŸŸç½‘çš„è¿æ¥
allow-lan: true
# è§„åˆ™æ¨¡å¼ (rule/global/direct)
mode: rule
# æ—¥å¿—ç­‰çº§ (info/warning/error/debug/silent)
log-level: info
# å¤–éƒ¨æ§åˆ¶çš„ API åœ°å€ (ç”¨äº Dashboard)
external-controller: '0.0.0.0:9090'
# å¤–éƒ¨æ§åˆ¶çš„ API å¯†é’¥ (å¯é€‰ï¼Œå»ºè®®è®¾ç½®)
# secret: 'your_secret_password'

#2. è®¢é˜…æä¾›è€… (Proxy Providers)
proxy-providers:
  # provider1 æ˜¯è¿™ä¸ªæä¾›è€…çš„åå­—ï¼Œå¯ä»¥è‡ªå®šä¹‰
  provider1:
    type: http
    # å»ºè®®ä½¿ç”¨ URL-encoded åçš„é“¾æ¥
    url: "https://s.040726.xyz/share/col/%E7%BB%84%E5%90%88%E8%AE%A2%E9%98%85?token=vUtHapFHX9I1t-nCNx46u"
    interval: 86400 # 24å°æ—¶æ›´æ–°ä¸€æ¬¡
    path: ./profiles/providers/primary.yaml
    health-check:
      enable: true
      interval: 300 # 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
      url: https://www.gstatic.com/generate_204

# 3. ä»£ç†ç­–ç•¥ç»„ (Proxy Groups)
proxy-groups:
  - name: 'âœˆï¸ â€èµ·é£'
    type: select
    proxies:
      - 'âš¡ â€ä½å»¶è¿Ÿ'
      - 'ğŸ”§ â€è‡ªå»º'
      - 'ğŸ•¹ï¸ EDT'
      - 'ğŸ‘†ğŸ» æŒ‡å®š'
      - 'ğŸ“œ å¤©ä¹¦'

  - name: 'âš¡ â€ä½å»¶è¿Ÿ'
    type: url-test
    url: 'https://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 100
    timeout: 2000
    # ä» provider1 è¿™ä¸ªæä¾›è€…ä¸­å¼•å…¥æ‰€æœ‰èŠ‚ç‚¹
    use:
      - provider1
    # æ’é™¤åå­—ä¸­å¸¦æœ‰'å¤©ä¹¦'çš„èŠ‚ç‚¹
    exclude-filter: 'å¤©ä¹¦'

  - name: 'ğŸ‘†ğŸ» æŒ‡å®š'
    type: select
    use:
      - provider1
    filter: 'ä¸“çº¿|è¶…é€Ÿ|CN2'
    proxies: []

  - name: 'ğŸ“œ å¤©ä¹¦'
    type: url-test
    url: 'https://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 100
    timeout: 2000
    use:
      - provider1
    filter: 'å¤©ä¹¦'
    proxies: []

  - name: 'ğŸ•¹ï¸ EDT'
    type: url-test
    url: 'https://www.gstatic.com/generate_204'
    interval: 300
    tolerance: 100
    timeout: 2000
    use:
      - provider1
    filter: 'EDT'
    proxies: []

  - name: 'ğŸ”§ â€è‡ªå»º'
    type: select
    use:
      - provider1
    filter: 'è‡ªå»º'
    proxies: []

  - name: 'ğŸ›©ï¸ â€å¢™å†…'
    type: select
    proxies:
      - DIRECT
      - REJECT

  - name: 'ğŸ’© â€å¹¿å‘Š'
    type: select
    proxies:
      - REJECT

  - name: 'ğŸ¤– â€AI'
    type: select
    use:
      - provider1
    # è¯·æ ¹æ®æ‚¨æœºåœºèŠ‚ç‚¹çš„å®é™…å‘½åä¿®æ”¹æ­¤å¤„çš„å…³é”®è¯
    filter: 'CN2'
    proxies: []

  - name: 'ğŸŒ â€æœªçŸ¥ç«™ç‚¹'
    type: select
    proxies:
      - 'âœˆï¸ â€èµ·é£'
      - 'ğŸ›©ï¸ â€å¢™å†…'
      - 'ğŸ’© â€å¹¿å‘Š'

# 4. è§„åˆ™æä¾›è€… (Rule Providers)
rule-providers:
  ProxyGFWlist:
    type: http
    behavior: domain
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt'
    path: ./ruleset/ProxyGFWlist.yaml
    interval: 86400

  LoyalDirect:
    type: http
    behavior: domain
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt'
    path: './ruleset/loyalsoldier-direct.yaml'
    interval: 86400

  LoyalCnCIDR:
    type: http
    behavior: ipcidr
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt'
    path: './ruleset/loyalsoldier-cncidr.yaml'
    interval: 86400

  LoyalLanCIDR:
    type: http
    behavior: ipcidr
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt'
    path: './ruleset/loyalsoldier-lancidr.yaml'
    interval: 86400

  reject:
    type: http
    behavior: domain
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt'
    path: './ruleset/reject.yaml'
    interval: 86400

  AD:
    type: http
    behavior: domain
    url: 'https://script.cx.ms/awavenue/AWAvenue-Ads-Rule-Clash.yaml'
    path: './ruleset/AWAvenue-Ads-Rule-Clash.yaml'
    interval: 86400

  AI:
    type: http
    behavior: classical
    url: 'https://fastly.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/Ruleset/Gemini.yaml'
    path: './ruleset/Gemini.yaml'
    interval: 86400

  Google:
    type: http
    behavior: classical
    url: 'https://fastly.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Providers/Ruleset/Google.yaml'
    path: './ruleset/Google.yaml'
    interval: 86400

  applications:
    type: http
    behavior: classical
    url: 'https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt'
    path: './ruleset/applications.yaml'
    interval: 86400

# 5. è·¯ç”±è§„åˆ™ (Rules)
rules:
  # è‡ªå»ºæœåŠ¡ç›´è¿
  - DOMAIN-SUFFIX,040726.xyz,DIRECT
  - DOMAIN-SUFFIX,nzh-nas.top,DIRECT
  - DOMAIN-SUFFIX,nzh-nas.me,DIRECT
  
  # å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,reject,ğŸ’© â€å¹¿å‘Š,no-resolve
  - RULE-SET,AD,ğŸ’© â€å¹¿å‘Š,no-resolve
  
  # å›½å†…/ç›´è¿æœåŠ¡
  - RULE-SET,LoyalDirect,DIRECT,no-resolve
  - RULE-SET,LoyalLanCIDR,DIRECT,no-resolve
  - RULE-SET,LoyalCnCIDR,DIRECT,no-resolve
  - GEOIP,CN,DIRECT,no-resolve
  - RULE-SET,applications,DIRECT,no-resolve
  
  # ä»£ç†è§„åˆ™
  - RULE-SET,AI,ğŸ¤– â€AI,no-resolve
  - RULE-SET,Google,ğŸ¤– â€AI,no-resolve
  - RULE-SET,ProxyGFWlist,âœˆï¸ â€èµ·é£,no-resolve
  
  # è‡ªå®šä¹‰ä»£ç†è§„åˆ™
  - DOMAIN-SUFFIX,linux.do,âœˆï¸ â€èµ·é£
  - DOMAIN-SUFFIX,cloudflare.com,âœˆï¸ â€èµ·é£
  - DOMAIN-SUFFIX,manus.monica.cn,ğŸ¤– â€AI
  
  # æœ€ç»ˆåŒ¹é…è§„åˆ™
  - MATCH,ğŸŒ â€æœªçŸ¥ç«™ç‚¹,no-resolve

# 6. DNS é…ç½®
dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  # fake-ip-filter å·²æ›´åä¸º fake-ip-filter-mode
  # fake-ip-filter-mode: blacklist
  prefer-h3: false
  respect-rules: false
  use-hosts: false
  use-system-hosts: false
  ipv6: true
  fake-ip-filter:
    - '*.lan'
    - '*.local'
    - '*.arpa'
    - 'time.*.com'
    - 'ntp.*.com'
    - '*.market.xiaomi.com'
    - 'localhost.ptlogin2.qq.com'
    - '*.msftncsi.com'
    - 'www.msftconnecttest.com'
  default-nameserver:
    - 'system'
    - '223.6.6.6'
    - '8.8.8.8'
    - '2400:3200::1'
    - '2001:4860:4860::8888'
  nameserver:
    - '8.8.8.8'
    - 'https://doh.pub/dns-query'
    - 'https://dns.alidns.com/dns-query'
  # direct-nameserver-follow-policy: false  # æ­¤é€‰é¡¹å¯èƒ½å·²åºŸå¼ƒæˆ–ä½œç”¨ä¸å¤§ï¼Œå¯çœç•¥
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - '240.0.0.0/4'
      - '0.0.0.0/32'
    domain:
      - '+.google.com'
      - '+.facebook.com'
      - '+.youtube.com'
  proxy-server-nameserver:
    - 'https://doh.pub/dns-query'
    - 'https://dns.alidns.com/dns-query'
    - 'tls://223.5.5.5'